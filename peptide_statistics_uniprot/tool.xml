<toolset>

<pathSet base="peptide_statistics3">
    <toolPath tool="protein_coverage_calculation_paramgeneration" path="parallel_protein_coverage_paramgen.py" />
    <pathVar name="protein_coverage_calculation_map.script" path="protein_coverage_calculate.py" />
    <pathVar name="unique_peptide_calculation_map.script" path="unique_peptide_calculation_parallel.py" />
    <pathVar name="protein_coverage_calculation_reduce.script" path="parallel_reduce_protein_coverage.py" />
    <pathVar name="peptide_stats_coverage_map.script" path="peptide_stats_coverage_map.py" />

    <pathVar name="merge_tsv_efficient.script" path="merge_tsv_files_efficient.py" />

    <pathVar name="uniprot_gff_pkl" path="uniprot_annotations.pkl" />
    <pathVar name="next_prot_pe" path="NextProt_PEs.txt" />

</pathSet>


    <pathSet base="anaconda2">
        <toolPath tool="unique_peptide_calculation_map" path="bin/python2.7" />
        <toolPath tool="protein_coverage_calculation_reduce" path="bin/python2.7" />
    </pathSet>

    <pathSet base="anaconda3">
        <toolPath tool="protein_coverage_calculation_map" path="bin/python3.5" />
        <toolPath tool="peptide_stats_coverage_map" path="bin/python3.5" />
        <toolPath tool="merge_tsv_efficient" path="bin/python3.5" />
    </pathSet>


<tool name="protein_coverage_calculation_paramgeneration">
    <require name="fastadb" type="file"/>
    <require name="peptidelist"       type="file"/>
    <require name="params"    type="file"/>
    <produce name="parallel_params"        type="folder"/>

    <execution env="binary" argConvention="adhoc">
            <arg valueRef="fastadb"/>
            <arg valueRef="peptidelist"/>
            <arg valueRef="parallel_params"/>
            <arg value="20"/>
    </execution>
</tool>


<tool name="protein_coverage_calculation_map">
    <require name="peptidelist"       type="file"/>
    <require name="fastadb" type="file"/>
    <require name="params"    type="file"/>
    <require name="parallel_params"    type="file"/>
    <produce name="intermediate_protein_coverage"        type="folder"/>
    <produce name="debug_protein_coverage"        type="folder"/>

    <execution env="binary" argConvention="adhoc">
            <arg pathRef="protein_coverage_calculation_map.script"/>
            <arg valueRef="fastadb"/>
            <arg valueRef="peptidelist"/>
            <arg valueRef="parallel_params"/>
            <arg pathRef="uniprot_gff_pkl"/>
            <arg pathRef="next_prot_pe"/>
            <arg valueRef="intermediate_protein_coverage"/>
            <arg valueRef="debug_protein_coverage"/>
    </execution>
</tool>

<tool name="unique_peptide_calculation_map">
    <require name="peptidelist"       type="file"/>
    <require name="fastadb" type="file"/>
    <require name="params"    type="file"/>
    <require name="parallel_params"    type="file"/>
    <produce name="intermediate_unique_peptide_coverage"        type="folder"/>

    <execution env="binary" argConvention="adhoc">
        <arg pathRef="unique_peptide_calculation_map.script"/>
        <arg valueRef="fastadb"/>
        <arg valueRef="peptidelist"/>
        <arg valueRef="parallel_params"/>
        <arg pathRef="next_prot_pe"/>
        <arg valueRef="intermediate_unique_peptide_coverage"/>
    </execution>
</tool>


<tool name="protein_coverage_calculation_reduce">
    <require name="peptidelist"       type="file"/>
    <require name="fastadb" type="file"/>
    <require name="params"    type="file"/>
    <require name="intermediate_protein_coverage"    type="folder"/>
    <require name="intermediate_unique_peptide_coverage"    type="folder"/>
    <produce name="protein_coverage"        type="file" naming="explicit"  extension="out"/>
    <produce name="unique_peptides_list"        type="file" naming="explicit"  extension="out"/>
    <produce name="library_coverage_summary_statistics"        type="file" naming="explicit"  extension="tsv"/>

    <execution env="binary" argConvention="adhoc">
        <arg pathRef="protein_coverage_calculation_reduce.script"/>
        <arg valueRef="fastadb"/>
        <arg valueRef="intermediate_protein_coverage"/>
        <arg valueRef="intermediate_unique_peptide_coverage"/>
        <arg valueRef="protein_coverage"/>
        <arg valueRef="unique_peptides_list"/>
        <arg pathRef="next_prot_pe"/>
        <arg valueRef="library_coverage_summary_statistics"/>
    </execution>
</tool>


<tool name="peptide_stats_coverage_map">
    <require name="peptidelist"       type="file"/>
    <require name="fastadb" type="file"/>
    <require name="params"    type="file"/>
    <require name="parallel_params"    type="file"/>
    <produce name="intermediate_peptide_coverage"        type="folder"/>

    <execution env="binary" argConvention="adhoc">
        <arg pathRef="peptide_stats_coverage_map.script"/>
        <arg valueRef="fastadb"/>
        <arg valueRef="peptidelist"/>
        <arg valueRef="parallel_params"/>
        <arg pathRef="uniprot_gff_pkl"/>
        <arg pathRef="next_prot_pe"/>
        <arg valueRef="intermediate_peptide_coverage"/>
    </execution>
</tool>

<tool name="merge_tsv_efficient">
    <require name="input_folder" type="folder"/>
    <produce name="output_file" type="file" naming="explicit"  extension="tsv"/>

    <execution env="binary" argConvention="adhoc">
        <arg pathRef="merge_tsv_efficient.script"/>
        <arg valueRef="input_folder"/>
        <arg valueRef="output_file"/>
    </execution>
</tool>




</toolset>
